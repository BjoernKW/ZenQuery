"use strict";angular.module("services.config",[]).constant("configuration",{apiRootURL:"../",deleteAllowed:"false",databaseEditAllowed:"false"});var zenQueryServices=angular.module("zenQueryServices",["ngResource","services.config"]);zenQueryServices.factory("DatabaseConnection",["$resource","configuration",function(a,b){return a(b.apiRootURL+"api/v1/databaseConnections/:databaseConnectionId",{},{findAll:{method:"GET",params:{databaseConnectionId:"findAll"},isArray:!0},get:{method:"GET"},create:{method:"POST"},update:{params:{databaseConnectionId:"@id"},method:"PUT"},"delete":{method:"DELETE"}})}]).factory("Query",["$resource","configuration",function(a,b){return a(b.apiRootURL+"api/v1/queries/:queryId",{},{findAll:{method:"GET",params:{queryId:"findAll"},isArray:!0},get:{method:"GET"},create:{method:"POST"},update:{params:{queryId:"@id"},method:"PUT"},"delete":{method:"DELETE"}})}]).factory("QueryFinder",["$resource","configuration",function(a,b){return a(b.apiRootURL+"api/v1/queries/:action/:databaseConnectionId",{},{findByDatabaseConnectionId:{method:"GET",params:{action:"findByDatabaseConnectionId"},isArray:!0}})}]).factory("QueryVersion",["$resource","configuration",function(a,b){return a(b.apiRootURL+"api/v1/queryVersions/:queryVersionId",{},{findAll:{method:"GET",params:{queryVersionId:"findAll"},isArray:!0},get:{method:"GET"},create:{method:"POST"},update:{params:{queryVersionId:"@id"},method:"PUT"},"delete":{method:"DELETE"}})}]).factory("QueryVersionFinder",["$resource","configuration",function(a,b){return a(b.apiRootURL+"api/v1/queryVersions/:action/:queryId",{},{findByQueryId:{method:"GET",params:{action:"findByQueryId"},isArray:!0},findPreviousVersionsByQueryId:{method:"GET",params:{action:"findPreviousVersionsByQueryId"},isArray:!0},findCurrentByQueryId:{method:"GET",params:{action:"findCurrentByQueryId"}}})}]).factory("ResultSet",["$resource","configuration",function(a,b){return a(b.apiRootURL+"api/v1/resultSetForQuery/:queryId/:variables/size/:size",{},{get:{method:"GET",isArray:!0}})}]).factory("ResultSetFinder",["$resource","configuration",function(a,b){return a(b.apiRootURL+"api/v1/resultSetForQuery/:queryId/:version",{},{get:{method:"GET",isArray:!0}})}]),angular.module("zenQueryUiApp",["ngCookies","ngResource","ngSanitize","ngRoute","pascalprecht.translate","ui.select2","ui.bootstrap","chieffancypants.loadingBar","ngAnimate","services.config","zenQueryServices"]).config(["$routeProvider","$translateProvider",function(a,b){a.when("/",{templateUrl:"views/queries.html",controller:"QueriesCtrl"}).when("/databaseConnections",{templateUrl:"views/databaseConnections.html",controller:"DatabaseConnectionsCtrl"}).when("/queries/:databaseConnectionId",{templateUrl:"views/queries.html",controller:"QueriesCtrl"}).otherwise({redirectTo:"/"}),b.translations("en_UK",{NAME:"Name",URL:"URL",USERNAME:"Username",PASSWORD:"Password",TOTAL:"Total",HOME:"Home",CONTACT:"Contact",ABOUT:"About",DATABASE_CONNECTIONS:"Database connections",QUERIES:"Queries",VERSIONS:"Versions",RESULT_SETS:"Result sets",RESULT_SET:"Result set",DETAILS:"Details",CREATE:"Create",UPDATE:"Update",DELETE:"Delete",EXECUTE:"Execute",NEW:"New",KEY:"ID",QUERY:"Query",CONTENT:"Content",SELECT:"Please select",DATABASE_CONNECTION:"Database connection",PREVIOUS_VERSIONS:"Previous versions",PREVIOUS_VERSION:"Previous version",SNAPSHOTS:"Snapshots",SNAPSHOT:"Snapshot",ARGUMENTS:"Arguments",HTML_LIST:"HTML list",STYLED_HTML_LIST:"styled HTML list",HTML_TABLE:"HTML table",STYLED_HTML_TABLE:"styled HTML table",FOR_ALL_RESULTS:"for all results please click on one of the links above or below this table"}),b.translations("de_DE",{NAME:"Name",URL:"URL",USERNAME:"Nutzername",PASSWORD:"Passwort",TOTAL:"Gesamt",HOME:"Home",CONTACT:"Impressum",ABOUT:"Infos",DATABASE_CONNECTIONS:"Datenbankverbindungen",QUERIES:"Abfragen",VERSIONS:"Versionen",RESULT_SETS:"Abfrageergebnisse",RESULT_SET:"Abfrageergebnis",DETAILS:"Details",CREATE:"Erstellen",UPDATE:"Aktualisieren",DELETE:"Löschen",EXECUTE:"Ausführen",NEW:"Neu",KEY:"ID",QUERY:"Abfrage",CONTENT:"Inhalt",SELECT:"Bitte auswählen",DATABASE_CONNECTION:"Datenbankverbindung",PREVIOUS_VERSIONS:"Vorherige Versionen",PREVIOUS_VERSION:"Vorherige Version",SNAPSHOTS:"Snapshots",SNAPSHOT:"Snapshot",ARGUMENTS:"Argumente",HTML_LIST:"HTML Liste",STYLED_HTML_LIST:"HTML Liste mit Layout",HTML_TABLE:"HTML Tabelle",STYLED_HTML_TABLE:"HTML Tabelle mit Layout",FOR_ALL_RESULTS:"für alle Ergebnisse klicken Sie bitte auf einen der Links ober- oder unterhalb dieser Tabelle"}),b.preferredLanguage("en_UK")}]),angular.module("zenQueryUiApp").controller("MainCtrl",function(){}),angular.module("zenQueryUiApp").controller("DatabaseConnectionsCtrl",["$scope","DatabaseConnection","configuration",function(a,b,c){var d=function(b){var c=(a.currentPage-1)*a.itemsPerPage,d=c+a.itemsPerPage;b.sort(function(a,b){return a.id-b.id}),a.filteredDatabaseConnections=b.slice(c,d)},e=function(){a.databaseConnections=b.findAll(function(b){a.total=b.length,d(b)})};a.selectRow=function(b){a.selectedRow=b},a.showDetails=function(c){a.databaseConnection=b.get({databaseConnectionId:c})},a.numberOfPages=function(){return Math.ceil(a.databaseConnections.length/a.itemsPerPage)},a.selectPage=function(b){a.currentPage=b,d(a.databaseConnections)},a.new=function(){a.databaseConnection=null},a.create=function(){a.databaseConnection=b.create(a.databaseConnection,function(){e()})},a.update=function(){b.update(a.databaseConnection,function(){e()})},a.delete=function(a){b.delete({databaseConnectionId:a},function(){e()})},a.configuration=c;var f=new Date;a.currentYear=f.getFullYear(),a.filteredDatabaseConnections=[],a.currentPage=1,a.itemsPerPage=5,a.maxSize=5,e()}]),angular.module("zenQueryUiApp").controller("QueriesCtrl",["$scope","$routeParams","Query","QueryFinder","QueryVersion","QueryVersionFinder","DatabaseConnection","ResultSet","configuration",function(a,b,c,d,e,f,g,h,i){var j=function(b){var c=(a.currentPage-1)*a.itemsPerPage,d=c+a.itemsPerPage;b.sort(function(a,b){return a.id-b.id}),a.filteredQueries=b.slice(c,d)},k=function(){a.queries=b.databaseConnectionId?d.findByDatabaseConnectionId({databaseConnectionId:b.databaseConnectionId},function(b){a.total=b.length,j(b)}):c.findAll(function(b){a.total=b.length,j(b)})},l=function(){a.databaseConnections=g.findAll()},m=function(b){for(var c=b.content.match(/\?/g),d=null!==c?c.length:0,e=[],f=0;d>f;f++)e.push({id:f});a.variables=e,a.variableValues=new Array(d)};a.selectRow=function(b){a.selectedRow=b},a.numberOfPages=function(){return Math.ceil(a.queries.length/a.itemsPerPage)},a.selectPage=function(b){a.currentPage=b,j(a.queries)},a.showDetails=function(b){a.query=c.get({queryId:b},function(b){a.queryVersion={},a.queryVersion.content=b.content,m(a.query),a.execute()})},a.execute=function(){a.joinedVariables="",a.variableValues&&a.variableValues.length>0&&(a.joinedVariables=a.variableValues.join(",")),a.resultSet=h.get({queryId:a.query.id,variables:a.joinedVariables,size:a.maxSize},function(){var b=a.queryVersion.content;a.queryVersions=f.findPreviousVersionsByQueryId({queryId:a.query.id},function(){a.queryVersion.content=b,a.queryVersions.sort(function(a,b){return b.id-a.id})})})},a.loadPreviousVersion=function(b){null!==a.queryVersion&&(a.queryVersion.content=b)},a.new=function(){a.query=null,a.queryVersion=null,a.queryVersions=null,a.variables=null},a.create=function(){if(null!==a.queryVersion&&a.queryVersion.content.length>0&&null!==a.query){var b=a.query;b.content=a.queryVersion.content,a.query=c.create(b,function(){k(),m(a.query),a.execute()})}},a.update=function(){null!==a.queryVersion&&a.queryVersion.content.length>0&&(a.query.content=a.queryVersion.content,c.update(a.query,function(){k(),m(a.query),a.execute()}))},a.delete=function(b){c.delete({queryId:b},function(){a.new(),k()})},a.configuration=i;var n=new Date;a.currentYear=n.getFullYear(),a.filteredQueries=[],a.currentPage=1,a.itemsPerPage=5,a.maxSize=5,k(),l()}]),angular.module("zenQueryUiApp").controller("QueryVersionCtrl",function(){}),angular.module("zenQueryUiApp").controller("ResultSetsCtrl",["$scope",function(a){a.selectRow=function(b){a.selectedRow=b};var b=new Date;a.currentYear=b.getFullYear()}]);